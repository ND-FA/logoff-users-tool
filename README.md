# Утилита для завершения сеансов пользователей Windows

Это Windows Forms приложение предназначено для отправки уведомлений пользователям на удаленных серверах и последующего принудительного завершения их сеансов по истечении заданного времени. Утилита упрощает процесс планового обслуживания серверов, требующего отсутствия активных пользовательских сессий.

![Main Window](https://github.com/user-attachments/assets/0124ec71-aa0b-488f-aac1-c2b22d009e17)

## Технологии

- **C# .NET Framework**: Основа приложения.
- **Windows Forms**: Графический интерфейс.
- **PowerShell**: Для поиска серверов в домене (опционально).

## Ключевые особенности

-   **Выбор сервера**: Укажите имя или IP-адрес целевого сервера.
-   **Поиск серверов**: Автоматический поиск доступных серверов в сети.
-   **Настраиваемый таймер**: Установите общее время (в секундах) до завершения сеансов.
-   **Интервал уведомлений**: Задайте, как часто (в секундах) пользователи будут получать всплывающие окна с напоминанием.
-   **Пользовательский текст сообщения**: Вы можете изменить основной текст сообщения, отправляемого пользователям.
-   **Иконка приложения**: Используется кастомная иконка для лучшей узнаваемости.
-   **Управление процессом**: Кнопки "Старт" и "Стоп" для запуска и прерывания процесса. Кнопка "Старт" блокируется на время выполнения операции для предотвращения случайных повторных запусков.
-   **Информативный прогресс-бар**: Наглядно отображает оставшееся время до завершения операции. По умолчанию и после отмены остается пустым, устраняя визуальный шум.
-   **Логирование**: Все действия, найденные сессии и ошибки отображаются в окне приложения.
-   **Сохранение настроек**:
    -   Приложение автоматически сохраняет последние использованные параметры (сервер, таймер, интервал, сообщение), а также размер и положение окна, и загружает их при следующем запуске.
    -   Есть возможность сохранять и загружать "Настройки по умолчанию".

## Как использовать

### Начальная настройка

При первом запуске рекомендуется настроить и сохранить параметры по умолчанию. Для этого нажмите кнопку **Настройки**.

### Основной интерфейс

1.  **Сервер**: Введите имя хоста или IP-адрес сервера, на котором нужно завершить сеансы. Вы также можете использовать кнопку **Поиск** для автоматического обнаружения серверов.
2.  **Таймер (секунды)**: Установите общее время до завершения сеансов. Например, `900` для 15 минут.
3.  **Интервал уведомлений (сек)**: Установите частоту напоминаний. Например, `60`, чтобы отправлять уведомления каждую минуту.
4.  **Сообщение**: Введите основной текст уведомления. Например: `Сервер будет перезагружен для проведения технических работ. Пожалуйста, сохраните все открытые документы.` К этому тексту будет автоматически добавлено оставшееся время.
5.  **Старт**: Нажмите для запуска процесса. Кнопка будет заблокирована до завершения или отмены операции.
6.  **Стоп**: Нажмите, чтобы немедленно прервать обратный отсчет. В лог будет выведено сообщение об отмене, а принудительного завершения сеансов не произойдет.
7.  **Очистить**: Очищает окно с логами.
8.  **Настройки**: Открывает окно для редактирования и сохранения настроек по умолчанию.
9.  **Сброс**: Загружает в поля на главной форме сохраненные настройки по умолчанию.
10. **Поиск**: Инициирует поиск серверов в сети.

### Окно настроек

![Settings Window](https://github.com/user-attachments/assets/f1fded1e-c90c-40d3-add9-18eb7debc2a6)


-   **Список серверов по умолчанию**: Здесь вы можете составить список серверов, который будет загружаться при запуске или при нажатии кнопки **Сброс**.
-   **Таймер и интервал по умолчанию**: Установите стандартные значения для таймера и интервала.
-   **Сообщение по умолчанию**: Задайте стандартный текст сообщения.
-   **Сохранить**: Сохраняет все указанные параметры как настройки по умолчанию.
-   **Отмена**: Закрывает окно без сохранения изменений.

## Системные требования

- **ОС**: Windows с установленным .NET Framework 4.7.2 или выше.
- **Права**: Для корректной работы утилиты необходимы права администратора на целевых серверах для отправки сообщений и завершения сеансов.

## Предупреждения

-   Убедитесь, что у вас есть необходимые разрешения для выполнения удаленных действий на целевых серверах.
-   Используйте функцию принудительного завершения сеансов с осторожностью, так как это может привести к потере несохраненных данных у пользователей.
-   Поиск серверов может занять некоторое время в зависимости от размера и конфигурации вашей сети.
